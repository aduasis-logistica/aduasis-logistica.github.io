"use strict";(self.webpackChunkaduasis_docs=self.webpackChunkaduasis_docs||[]).push([[2979],{320:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>c,contentTitle:()=>o,default:()=>u,frontMatter:()=>s,metadata:()=>t,toc:()=>l});var a=n(5893),i=n(1151);const s={},o="\ud83d\udcbb Portal SPA",t={id:"documentacion/productos/portal-spa",title:"\ud83d\udcbb Portal SPA",description:"Ir al repositorio en Github (Es necesario tener permisos)",source:"@site/doc/documentacion/productos/3-portal-spa.md",sourceDirName:"documentacion/productos",slug:"/documentacion/productos/portal-spa",permalink:"/docs/documentacion/productos/portal-spa",draft:!1,unlisted:!1,editUrl:"https://github.com/aduasis-logistica/aduasis-logistica.github.io/tree/main/doc/documentacion/productos/3-portal-spa.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{},sidebar:"documentacionSidebar",previous:{title:"\ud83d\udda8 API Jaspers",permalink:"/docs/documentacion/productos/api-reportes-jasper"},next:{title:"\ud83c\udf10 Microservicios portal",permalink:"/docs/documentacion/productos/microservicios-portal"}},c={},l=[{value:"\u2139\ufe0f \xbfQu\xe9 es?",id:"\u2139\ufe0f-qu\xe9-es",level:2},{value:"Infraestructura",id:"infraestructura",level:3},{value:"Factura light - Tablas",id:"factura-light---tablas",level:3},{value:"\ud83d\udcbf Instalaci\xf3n",id:"-instalaci\xf3n",level:2},{value:"Depurar aplicaci\xf3n",id:"depurar-aplicaci\xf3n",level:4},{value:"Librer\xedas para consultar APIs / OpenAPI Generator",id:"librer\xedas-para-consultar-apis--openapi-generator",level:3},{value:"\ud83d\udd28 Compilaci\xf3n",id:"-compilaci\xf3n",level:2},{value:"\ud83d\ude80 Despliegue",id:"-despliegue",level:2},{value:"Despliegue en IIS",id:"despliegue-en-iis",level:2},{value:"IIS Webconfig para portal SPA",id:"iis-webconfig-para-portal-spa",level:3},{value:"IIS Webconfig para Reverse Proxy",id:"iis-webconfig-para-reverse-proxy",level:3}];function d(e){const r={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.a)(),...e.components},{Details:n}=r;return n||function(e,r){throw new Error("Expected "+(r?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.h1,{id:"-portal-spa",children:"\ud83d\udcbb Portal SPA"}),"\n",(0,a.jsx)(r.admonition,{title:"Enlace a repositorio",type:"info",children:(0,a.jsx)(r.p,{children:(0,a.jsx)(r.a,{href:"https://github.com/aduasis-logistica/app-portal",children:"Ir al repositorio en Github (Es necesario tener permisos)"})})}),"\n",(0,a.jsxs)(n,{children:[(0,a.jsx)("summary",{children:(0,a.jsx)(r.strong,{children:"\ud83e\uddea Stack tecnol\xf3gico"})}),(0,a.jsx)(r.p,{children:"Lenguajes de programaci\xf3n:"}),(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsx)(r.li,{children:"Typescript"}),"\n"]}),(0,a.jsx)(r.p,{children:"IDEs/Editores recomendados:"}),(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsx)(r.li,{children:"Visualstudio code"}),"\n",(0,a.jsx)(r.li,{children:"Webstorm"}),"\n"]}),(0,a.jsx)(r.p,{children:"\xbfQu\xe9 necesito saber?"}),(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsx)(r.li,{children:"Angular"}),"\n",(0,a.jsx)(r.li,{children:"M\xf3dulo para formularios reactivos en Angular."}),"\n",(0,a.jsx)(r.li,{children:"RXJS Para el manejo de eventos as\xedncronos en flujo de datos."}),"\n",(0,a.jsx)(r.li,{children:"OpenAPI Generator."}),"\n",(0,a.jsx)(r.li,{children:"NPM."}),"\n",(0,a.jsx)(r.li,{children:"Docker."}),"\n"]})]}),"\n",(0,a.jsx)(r.admonition,{title:"Pendientes",type:"danger",children:(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:["Restringir acceso de p\xe1ginas m\xf3dulos, si bien no aparecen en el men\xfa los modulos de acuerdo a lo que esta configurado en webmodulo si el usuario tiene el url directo para entrar a la p\xe1gina podr\xe1 hacerlo. Por lo tanto, es necesario aplicar ",(0,a.jsx)(r.a,{href:"https://binarycoffee.dev/post/guards-en-angular-como-funcionan",children:"Guards"})," al proyecto."]}),"\n"]})}),"\n",(0,a.jsx)(r.h2,{id:"\u2139\ufe0f-qu\xe9-es",children:"\u2139\ufe0f \xbfQu\xe9 es?"}),"\n",(0,a.jsx)(r.p,{children:"El surgimiento de Portal SPA responde a la imperante necesidad de actualizar las tecnolog\xedas empleadas en un proyecto preexistente dedicado a la gesti\xf3n de operaciones aduaneras. En este contexto, se busca efectuar una transici\xf3n desde una arquitectura monol\xedtica hacia un enfoque basado en microservicios. El prop\xf3sito central de esta iniciativa es lograr un desacoplamiento completo entre la interfaz visual y la l\xf3gica de la aplicaci\xf3n."}),"\n",(0,a.jsx)(r.p,{children:"Portal SPA representa la faceta del proyecto centrada en la experiencia visual del usuario con el sistema. Esta transformaci\xf3n permitir\xe1 una mayor flexibilidad, escalabilidad y mantenibilidad, mejorando as\xed la eficiencia global del sistema de gesti\xf3n de operaciones aduaneras."}),"\n",(0,a.jsx)(r.h3,{id:"infraestructura",children:"Infraestructura"}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.img,{src:"https://i.imgur.com/OxHkbvH.png",alt:"Diagrama de infraestructura"})}),"\n",(0,a.jsx)(r.h3,{id:"factura-light---tablas",children:"Factura light - Tablas"}),"\n",(0,a.jsx)(r.mermaid,{value:'erDiagram \r\n    ffactura_gen_light ||--|{  ffactura_det_light : "1..*"\r\n    ffactura_det_light ||--|{ ffactura_det_light_series : "1..*"\r\n    ffactura_det_light ||--|| ffactura_clas_light: "1..1"\r\n    ffactura_det_light ||--|{ frel_fact_perm : "1..*" \r\n    ffactura_det_light ||--|{ ffactura_detalle_caso : "1..*" \r\n    \r\n  \r\n\r\n    ffactura_gen_light{\r\n        VARCHAR(36) id_factura PK\r\n        VARCHAR(15) id_pack_list PK \r\n        VARCHAR(6) id_cliente PK\r\n        VARCHAR(6) id_proveedor PK\r\n    }\r\n\r\n    ffactura_det_light{\r\n        VARCHAR(36) id_factura PK,FK\r\n        VARCHAR(15) id_pack_list PK,FK\r\n        DECIMAL(4_0) num_detalle PK\r\n        VARCHAR(6) id_cliente PK,FK\r\n        VARCHAR(6) id_proveedor PK,FK\r\n    }\r\n    \r\n    ffactura_det_light_series{\r\n        VARCHAR(36) id_factura PK,FK\r\n        VARCHAR(15) id_pack_list PK,FK\r\n        DECIMAL(4_0) num_detalle PK,FK\r\n        VARCHAR(6) id_cliente PK,FK\r\n        VARCHAR(6) id_proveedor PK,FK\r\n        INT num_secuencial PK\r\n    }\r\n    \r\n    ffactura_clas_light{\r\n        VARCHAR(36) id_factura PK,FK\r\n        VARCHAR(15) id_pack_list PK,FK\r\n        VARCHAR(6) id_proveedor PK,FK\r\n        VARCHAR(6) id_cliente PK,FK\r\n        DECIMAL(4_0) num_secuencial_factura PK, FK\r\n     }\r\n\r\n \r\n \r\n    frel_fact_perm{\r\n        VARCHAR(36) id_factura PK "FK"\r\n        NUMERIC(5_0) num_secuencial PK "FK"\r\n        VARCHAR(6) id_cliente PK "FK"\r\n        VARCHAR(6) id_proveedor PK "FK"\r\n        VARCHAR(50) id_producto PK "FK"\r\n        VARCHAR(2) id_permiso PK \r\n        VARCHAR(30) num_permiso PK\r\n    }\r\n\r\n\r\n    ffactura_detalle_caso{\r\n        VARCHAR(36) id_factura PK,FK\r\n        VARCHAR(6) id_cliente PK,FK\r\n        VARCHAR(6) id_proveedor PK,FK\r\n        NUMERIC(5_0) numero_secuencial PK,FK\r\n        NUMERIC(4_0) numero_identificador PK\r\n        CHAR(3) tipo_caso PK\r\n    }\r\n\r\n\r\n\r\n'}),"\n",(0,a.jsx)(r.mermaid,{value:'erDiagram \r\n    fpedimento ||--|{ frel_pedimento_factura: "1..*"\r\n    fpedimento ||--|{ frel_partidas_factura_pedimento: "1..*"\r\n\r\n  fpedimento{\r\n        VARCHAR(10) id_referencia PK\r\n        NUMERIC(1_0) id_rectificacion PK \r\n     }\r\n\r\n     frel_pedimento_factura{\r\n        VARCHAR(10) id_referencia PK,FK \r\n        NUMERIC(1_0) id_rectificacion PK,FK\r\n        VARCHAR(36) id_factura PK\r\n        VARCHAR(6) id_proveedor PK\r\n        DATETIME fecha_factura PK "\xbf\xbfPK??"\r\n        NUMERIC(18_0) consecutivo PK\r\n     }\r\n\r\n    frel_partidas_factura_pedimento{\r\n        VARCHAR(10) id_referencia PK "FK2"\r\n        DECIMAL(1_0) id_rectificacion PK\r\n        VARCHAR(36) id_factura PK "FK1"\r\n        VARCHAR(15) id_pack_list PK "FK1"\r\n        DECIMAL(4_0) num_detalle PK "FK1"\r\n        VARCHAR(6) id_cliente "FK1"\r\n        VARCHAR(6) id_proveedor "FK1"\r\n    }\r\n'}),"\n",(0,a.jsx)(r.h2,{id:"-instalaci\xf3n",children:"\ud83d\udcbf Instalaci\xf3n"}),"\n",(0,a.jsxs)(r.ol,{children:["\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["Descargar Node.js: ",(0,a.jsx)(r.a,{href:"https://nodejs.org/en/download/",children:"Clic aqui para descargar Node.js 20.10.0."})]}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["Descargar editor de c\xf3digo Visual Studio Code: ",(0,a.jsx)(r.a,{href:"https://code.visualstudio.com/",children:"Clic aqu\xed para descargar Visual Studio Code."})]}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsx)(r.p,{children:"Instalar Angular CLI: El proyecto esta basado en el framework de Angular en su version 17.0.9, por lo que se tendr\xe1 que ejecutar el siguiente comando en consola."}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-cmd",children:"npm -g install @angular/cli@17.0.9\r\n\n"})}),"\n",(0,a.jsx)(r.p,{children:"Ahora dirijase a la carpeta ra\xedz del proyecto desde la terminal y ejecute el comando de instalaci\xf3n de paquetes"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-cmd",children:"cd C:\\applicaciones\\portal-spa\r\nnpm install\n"})}),"\n",(0,a.jsx)(r.p,{children:"Por \xfaltimo arranque el proyecto desde la terminal"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-cmd",children:"ng serve\n"})}),"\n",(0,a.jsx)(r.h4,{id:"depurar-aplicaci\xf3n",children:"Depurar aplicaci\xf3n"}),"\n",(0,a.jsx)(r.p,{children:"Basta con correr la aplicaci\xf3n desde la terminal de visual studio code"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-cmd",children:"ng serve\n"})}),"\n",(0,a.jsx)(r.p,{children:"Y presionar sobre el bot\xf3n de depuraci\xf3n seleccionando 'Launch Chrome' en visual studio code."}),"\n",(0,a.jsx)(r.h3,{id:"librer\xedas-para-consultar-apis--openapi-generator",children:"Librer\xedas para consultar APIs / OpenAPI Generator"}),"\n",(0,a.jsx)(r.p,{children:"OpenAPI es una especificaci\xf3n para describir APIs REST. Permite definir, en un formato estandarizado (normalmente en JSON o YAML), todos los detalles de una API, como sus endpoints, m\xe9todos, par\xe1metros, respuestas y esquemas de datos. Es \xfatil para documentar, compartir y consumir APIs de manera consistente."}),"\n",(0,a.jsx)(r.p,{children:"OpenAPI Generator es una herramienta que utiliza una definici\xf3n OpenAPI para generar autom\xe1ticamente c\xf3digo. Esto incluye:"}),"\n",(0,a.jsx)(r.p,{children:"Clientes para consumir la API en diferentes lenguajes (Java, Python, etc.).\r\nServidores con la estructura b\xe1sica de la API.\r\nDocumentaci\xf3n en varios formatos.\r\nFacilita el desarrollo al reducir el trabajo manual en la creaci\xf3n de c\xf3digo relacionado con APIs."}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.a,{href:"https://github.com/aduasis-logistica/app-library-generation",children:"Proyecto OPEN API Generator Aduasis"})}),"\n",(0,a.jsx)(r.h2,{id:"-compilaci\xf3n",children:"\ud83d\udd28 Compilaci\xf3n"}),"\n",(0,a.jsx)(r.p,{children:"Ejecute el siguiente comando en la terminal para compilar en un entorno de producci\xf3n."}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-cmd",children:"ng build --configuration=production --base-href=/SPA/ \n"})}),"\n",(0,a.jsxs)(r.admonition,{title:"Uso de la bandera base href /SPA/",type:"info",children:[(0,a.jsx)(r.p,{children:"Esta solo es si la aplicaci\xf3n va a ser desplegada en una ruta distinta a la ra\xedz del dominio."}),(0,a.jsx)(r.p,{children:"Por ejemplo, es \xfatil con Uber cuando ellos tienen como ruta ra\xedz uberfreight.com/ a portal Aduanero java y en una ruta uberfreight.com/SPA/ tienen la aplicaci\xf3n SPA. Esto por medio del uso de un Reverse Proxy para mantener un dominio con distintas aplicaciones."})]}),"\n",(0,a.jsx)(r.h2,{id:"-despliegue",children:"\ud83d\ude80 Despliegue"}),"\n",(0,a.jsx)(r.p,{children:"Basta con copiar y pegar el compilado en una servidor web de contenido est\xe1tico como puede ser IIS, sin embargo si se desea compartir el mismo enlace entre portal Java y portal SPA es necesario hacer una configuraci\xf3n por medio de un Reverse Proxy."}),"\n",(0,a.jsx)(r.h2,{id:"despliegue-en-iis",children:"Despliegue en IIS"}),"\n",(0,a.jsx)(r.p,{children:"Es necesario tener instalado las siguientes utilidades:"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsx)(r.li,{children:(0,a.jsx)(r.a,{href:"https://learn.microsoft.com/es-es/iis/extensions/url-rewrite-module/reverse-proxy-with-url-rewrite-v2-and-application-request-routing#prerequisites",children:"ARR Para reverse proxy"})}),"\n",(0,a.jsx)(r.li,{children:(0,a.jsx)(r.a,{href:"https://learn.microsoft.com/es-es/iis/extensions/url-rewrite-module/using-the-url-rewrite-module",children:"URL Rewrite"})}),"\n"]}),"\n",(0,a.jsx)(r.h3,{id:"iis-webconfig-para-portal-spa",children:"IIS Webconfig para portal SPA"}),"\n",(0,a.jsx)(r.p,{children:"El archivo de configuraci\xf3n para desplegar la aplicaci\xf3n SPA en un servidor IIS es la siguiente:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-xml",metastring:'title="web.config"',children:'<?xml version="1.0" encoding="UTF-8"?>\r\n<configuration>\r\n    <system.webServer>\r\n        <rewrite>\r\n        <rules>\r\n            <rule name="redirect all requests" stopProcessing="true">\r\n                <match url="^(.*)$" ignoreCase="false" />\r\n                <conditions logicalGrouping="MatchAll">\r\n                    <add input="{REQUEST_FILENAME}" matchType="IsFile" negate="true" pattern="" ignoreCase="false" />\r\n                </conditions>\r\n                <action type="Rewrite" url="index.html" appendQueryString="true" />\r\n            </rule>\r\n        </rules>\r\n    </rewrite>\r\n    </system.webServer>\r\n</configuration>\r\n\n'})}),"\n",(0,a.jsx)(r.h3,{id:"iis-webconfig-para-reverse-proxy",children:"IIS Webconfig para Reverse Proxy"}),"\n",(0,a.jsx)(r.p,{children:"Ejemplo de configuracion de reverse proxy de diversas APIs en una arquitecrua de microservicios en el mismo servidor pero en distintos puertos."}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8"?>\r\n<configuration>\r\n    <system.webServer>\r\n    \r\n        <rewrite>\r\n            <rules >\r\n                <rule name="Reverse Proxy to YMS" stopProcessing="true">\r\n                    <match url="^factura-light/(.*)" />\r\n                    \r\n                    <conditions logicalGrouping="MatchAll">\r\n                        <add input="{UNENCODED_URL}" pattern="^/factura-light/(.*)" />\r\n                    </conditions>\r\n                    \r\n                    <action type="Rewrite" url="http://localhost:5025/{C:1}" />\r\n                   \r\n                </rule>\r\n                 <rule name="Reverse Proxy to Reportes Jasper" stopProcessing="true">\r\n                    <match url="^reportes-jasper/(.*)" />\r\n                    <action type="Rewrite" url="http://AWADUSANDVU02:8080/{R:1}" />\r\n                </rule>\r\n                <rule name="Reverse Proxy to Seguridad Microservice" stopProcessing="true">\r\n                    <match url="^seguridad/(.*)" />\r\n                    <action type="Rewrite" url="http://AWADUSANDVU02:8060/{R:1}" /> \r\n                </rule>\r\n                <rule name="Reverse Proxy to Catalogos Microservice" stopProcessing="true">\r\n                    <match url="^catalogos/(.*)" />\r\n                    <action type="Rewrite" url="http://AWADUSANDVU02:8061/{R:1}" />\r\n                </rule>\r\n                 <rule name="Reverse Proxy to Digitalizacion Microservice" stopProcessing="true">\r\n                    <match url="^digitalizacion/(.*)" />\r\n                    <action type="Rewrite" url="http://AWADUSANDVU02:8062/{R:1}" />\r\n                </rule>\r\n                 <rule name="Reverse Proxy to Clasificacion Microservice" stopProcessing="true">\r\n                    <match url="^clasificacion/(.*)" />\r\n                    <action type="Rewrite" url="http://AWADUSANDVU02:8063/{R:1}" />\r\n                </rule>\r\n                 <rule name="Reverse ProxyProxy to FacturaLight Microservice" stopProcessing="true">\r\n                    <match url="^factura-light/(.*)" />\r\n                    <action type="Rewrite" url="http://AWADUSANDVU02:8064/{R:1}" />\r\n                </rule>  \r\n            </rules>\r\n        </rewrite>\r\n        <httpProtocol>\r\n          <customHeaders>\r\n\r\n                <add name="X-Forwarded-Proto" value="http" />\r\n                <add name="X-Forwarded-Port" value="80" />\r\n            </customHeaders>\r\n        </httpProtocol>\r\n            <security>\r\n               \x3c!----\x3e <requestFiltering allowDoubleEscaping="true" />\r\n            </security>--\x3e\r\n    </system.webServer>\r\n</configuration>\r\n\n'})})]})}function u(e={}){const{wrapper:r}={...(0,i.a)(),...e.components};return r?(0,a.jsx)(r,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},1151:(e,r,n)=>{n.d(r,{Z:()=>t,a:()=>o});var a=n(7294);const i={},s=a.createContext(i);function o(e){const r=a.useContext(s);return a.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function t(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),a.createElement(s.Provider,{value:r},e.children)}}}]);